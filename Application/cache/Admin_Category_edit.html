<?php/*声明assign函数渲染的变量*/?><?php/*声明assign函数渲染的变量*/?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>管理中心</title>
<meta name="robots" content="noindex, nofollow">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="http://localhost/Public/Admin/Styles/general.css" rel="stylesheet" type="text/css" />
<link href="http://localhost/Public/Admin/Styles/main.css" rel="stylesheet" type="text/css" />
<link href="http://localhost/Public/datepicker/jquery-ui-1.9.2.custom.min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" language="javascript" src="http://localhost/Public/datepicker/jquery-1.7.2.min.js"></script>
<script type="text/javascript" charset="utf-8" src="http://localhost/Public/datepicker/jquery-ui-1.9.2.custom.min.js"></script>
<script type="text/javascript" charset="utf-8" src="http://localhost/Public/datepicker/datepicker_zh-cn.js"></script>
<script type="text/javascript" charset="utf-8" src="http://localhost/Public/ueditor/ueditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="http://localhost/Public/ueditor/ueditor.all.min.js"> </script>
<script type="text/javascript" charset="utf-8" src="http://localhost/Public/ueditor/lang/zh-cn/zh-cn.js"></script>

</head>
<body>
<h1>
    <span class="action-span"><a href="http://localhost/Admin/Category/lst.html">商品分类列表</a></span>
    <span class="action-span1"><a href="#">管理中心</a></span>
    <span id="search_id" class="action-span1"> - 修改商品分类 </span>
    <div style="clear:both"></div>
</h1><div class="main-div">
    <form name="main_form" method="POST" action="" enctype="multipart/form-data" >
    	<input type="hidden" name="id" value="14" />
        <table cellspacing="1" cellpadding="3" width="100%">
			<tr>
				<td class="label">上级权限：</td>
				<td>
					<select name="parent_id">
						<option value="0">顶级权限</option>
						 
						<option  value="14">手机、数码</option>
						 
						<option  value="22">--------手机配件</option>
						 
						<option  value="24">----------------蓝牙耳机</option>
						 
						<option  value="25">----------------手机饰品</option>
						 
						<option  value="23">--------数码配件</option>
						 
						<option  value="26">----------------存储卡</option>
						 
						<option  value="27">----------------读卡器</option>
						 
						<option  value="15">家用电器</option>
						 
						<option  value="16">--------大家电</option>
						 
						<option  value="19">----------------平板电视</option>
						 
						<option  value="20">----------------空调</option>
						 
						<option  value="21">----------------冰箱</option>
						 
						<option  value="17">--------生活电器</option>
						 
						<option  value="18">--------厨房电器</option>
						 
						<option  value="28">文化用品</option>
						 
						<option  value="29">--------书</option>
						 
						<option  value="30">----------------php</option>
						 
						<option  value="31">----------------ios</option>
						 
						<option  value="32">测试商品分类属性</option>
						 
						<option  value="33">新的分类</option>
											</select>
				</td>
			</tr>
            <tr>
                <td class="label">分类名称：</td>
                <td>
                    <input  type="text" name="cat_name" value="手机、数码" />
                </td>
            </tr>
            <tr>
                <td class="label">筛选属性：</td>
                <td>
	                <ul>
	                		                			                <li>
		                	<a href="javascript:void(0);" onclick="addNew(this);">[+]</a>
		                    <select name="type_id[]">
			                    <option value="">选择类型</option>
			                    			                    <option selected="selected" value="1">手机</option>
			                    			                    <option  value="2">书</option>
			                    			                    <option  value="3">光盘</option>
			                    			                    <option  value="4">服装</option>
			                    			                    <option  value="5">笔记本</option>
			                    			                    <option  value="8">测试类型</option>
			                    		                    </select>
		                    <select attr_id="4" name="attr_id[]">
		                    	<option value="">选择属性</option>
		                    </select>
		                </li>
		                		                <li>
		                	<a href="javascript:void(0);" onclick="addNew(this);">[-]</a>
		                    <select name="type_id[]">
			                    <option value="">选择类型</option>
			                    			                    <option  value="1">手机</option>
			                    			                    <option  value="2">书</option>
			                    			                    <option  value="3">光盘</option>
			                    			                    <option  value="4">服装</option>
			                    			                    <option  value="5">笔记本</option>
			                    			                    <option selected="selected" value="8">测试类型</option>
			                    		                    </select>
		                    <select attr_id="15" name="attr_id[]">
		                    	<option value="">选择属性</option>
		                    </select>
		                </li>
		                		                	                </ul>
                </td>
            </tr>
            <tr>
                <td colspan="99" align="center">
                    <input type="submit" class="button" value=" 确定 " />
                    <input type="reset" class="button" value=" 重置 " />
                </td>
            </tr>
        </table>
    </form>
</div>
<script>
$("select[name='type_id[]']").change(function(){
	// 把下拉框给另一个变量，然后在后面的AJAX的大括号可以用_this这个变量代码这个拉框框，因为ajax中的$(this)已经不再代码下拉框了，而是代码那个AJAX
	var _this = $(this);
	// 获取选择的类型的ID
	var typeId = $(this).val();
	var opt = "<option value=''>选择属性</option>";
	// 如果选择了一个类型就执行AJAX取出个类型下的属性
	if(typeId != "")
	{
		$.ajax({
			type : "GET",
			url : "http://localhost/Admin/Goods/AjaxType.html?type_id="+typeId,
			dataType : "json",
			success : function(data)
			{
				// 从属性的下拉框上取出这个下拉框应该选中的属性的ID
				var attrId = _this.next("select").attr("attr_id");
				// 把返回的属性放到属性的下拉框中
				$(data).each(function(k,v){
					// 判断哪个属性应该是选中的状态
					if(v.id == attrId)
						var sel = 'selected="selected"';
					else
						var sel = '';
					opt += "<option "+sel+" value='"+v.id+"'>"+v.attr_name+"</option>";
				});
				// 放到属性的下拉框中
				_this.next("select").html(opt);
			}
		});
	}
	else
		_this.next("select").html(opt);
});
function addNew(a)
{
	var li = $(a).parent();
	if($(a).html() == "[+]")
	{
		var newli = li.clone(true);  // 深度克隆，把标签上的事件也克隆
		newli.find("a").html("[-]");
		li.after(newli);
	}
	else
		li.remove();
}
// 直接触AJAX事件取出属性
$("select[name='type_id[]']").trigger("change");
</script>
<?php/*声明assign函数渲染的变量*/?><div id="footer">yxy</div>
</body>
</html>

<script type="text/javascript" charset="utf-8" src="http://localhost/Public/Admin/Js/tron.js"></script>